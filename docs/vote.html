<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>vote.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>vote.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-Vote'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Vote">&#182;</a>
        </div>
        <h1>Vote</h1>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>This is a very central model. It is used to keep track of user preferences on
policy propositions and arguments.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">class</span> <span class="nc">Vote</span> <span class="o">&lt;</span> <span class="no">Ohm</span><span class="o">::</span><span class="no">Model</span>
  <span class="n">reference</span> <span class="ss">:citizen</span><span class="p">,</span> <span class="no">Citizen</span>
  <span class="n">reference</span> <span class="ss">:proposition</span><span class="p">,</span> <span class="no">Proposition</span>
  <span class="n">reference</span> <span class="ss">:argument</span><span class="p">,</span> <span class="no">Argument</span></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>We need to able to look up votes in several ways.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">index</span> <span class="ss">:citizen</span>
  <span class="n">index</span> <span class="ss">:proposition</span>
  <span class="n">index</span> <span class="ss">:argument</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-5'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-5">&#182;</a>
        </div>
        <p>På förekommen anledning&hellip;</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">validate</span>
    <span class="n">assert_present</span> <span class="ss">:citizen</span>
  <span class="k">end</span>
    </pre></div>
      </td>
    </tr>
    <tr id='section-Value'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-Value">&#182;</a>
        </div>
        <h2>Value</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-7'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-7">&#182;</a>
        </div>
        <p>A vote can have one of three values:</p>

<p>+1 (yes)</p>

<p>-1 (no)</p>

<p>0 (abstain) </p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="n">attribute</span> <span class="ss">:value</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-8'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-8">&#182;</a>
        </div>
        <p>Returns some Swedish words representing the value of a vote.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">value_text</span>
    <span class="k">case</span> <span class="n">value</span>
    <span class="k">when</span> <span class="s2">&quot;-1&quot;</span>
      <span class="s2">&quot;röstade nej&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;0&quot;</span>
      <span class="s2">&quot;avstod från att rösta&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;+1&quot;</span>
      <span class="s2">&quot;röstade ja&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;[value not found]&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
  </pre></div>
      </td>
    </tr>
    <tr id='section-9'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-9">&#182;</a>
        </div>
        <p>Returns color words corresponding to result, for CSS classes.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">value_color</span>
    <span class="k">case</span> <span class="n">value</span>
      <span class="k">when</span> <span class="s2">&quot;+1&quot;</span>
        <span class="s1">&#39;green&#39;</span>
      <span class="k">when</span> <span class="s2">&quot;0&quot;</span>
        <span class="s1">&#39;yellow&#39;</span>
      <span class="k">when</span> <span class="s2">&quot;-1&quot;</span>
        <span class="s1">&#39;red&#39;</span>
    <span class="k">end</span>
  <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-String_generators'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-String_generators">&#182;</a>
        </div>
        <h2>String generators</h2>
      </td>
      <td class=code>
        <div class='highlight'><pre></pre></div>
      </td>
    </tr>
    <tr id='section-11'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-11">&#182;</a>
        </div>
        <p>This generates the standard html representation of a vote, a kind of badge
displaying who voted, on what and the value of the vote (yes, no, abstain).</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">to_html</span>
    <span class="k">case</span> <span class="n">value</span>
    <span class="k">when</span> <span class="s2">&quot;-1&quot;</span>
      <span class="s2">&quot;&lt;i&gt;</span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&lt;/i&gt;&lt;/br&gt;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span> <span class="k">rescue</span> <span class="s2">&quot;N/A&quot;</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;röstade nej&lt;/span&gt;&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;0&quot;</span>
      <span class="s2">&quot;&lt;i&gt;</span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&lt;/i&gt;&lt;/br&gt;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span> <span class="k">rescue</span> <span class="s2">&quot;N/A&quot;</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;avstod&lt;/span&gt;&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;+1&quot;</span>
      <span class="s2">&quot;&lt;i&gt;</span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&lt;/i&gt;&lt;/br&gt;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span> <span class="k">rescue</span> <span class="s2">&quot;N/A&quot;</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;röstade ja&lt;/span&gt;&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;[value not found - </span><span class="si">#{</span><span class="n">value</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-12'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-12">&#182;</a>
        </div>
        <p>This is a one-line version of the &lsquo;vote badge&rsquo; that is used on citizen profiles.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">to_html_flat</span>
    <span class="k">case</span> <span class="n">value</span>
    <span class="k">when</span> <span class="s2">&quot;-1&quot;</span>
      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;röstade nej&lt;/span&gt; till </span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;0&quot;</span>
      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;avstod från att rösta&lt;/span&gt; om </span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">when</span> <span class="s2">&quot;+1&quot;</span>
      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">citizen</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2"> &lt;span class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;röstade ja&lt;/span&gt; till </span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">link</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;[value not found - </span><span class="si">#{</span><span class="n">value</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2">]&quot;</span>
    <span class="k">end</span>    
  <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-13'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-13">&#182;</a>
        </div>
        <p>DEPRECATED</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">link</span>
    <span class="k">if</span> <span class="n">proposition</span>
      <span class="s2">&quot;&lt;a href=&#39;/proposition/</span><span class="si">#{</span><span class="n">proposition</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39;&gt;</span><span class="si">#{</span><span class="nb">to_s</span><span class="si">}</span><span class="s2">&lt;/a&gt;&quot;</span>
    <span class="k">elsif</span> <span class="n">argument</span>
      <span class="s2">&quot;&lt;a href=&#39;/argument/</span><span class="si">#{</span><span class="n">argument</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&#39;&gt;</span><span class="si">#{</span><span class="nb">to_s</span><span class="si">}</span><span class="s2">&lt;/a&gt;&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span></pre></div>
      </td>
    </tr>
    <tr id='section-14'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-14">&#182;</a>
        </div>
        <p>DEPRECATED</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>  <span class="k">def</span> <span class="nf">boxlink</span>
    <span class="s2">&quot;&lt;div class=&#39;bg_</span><span class="si">#{</span><span class="n">value_color</span><span class="si">}</span><span class="s2">&#39;&gt;</span><span class="si">#{</span><span class="n">link</span><span class="si">}</span><span class="s2">&lt;/div&gt;&quot;</span>
  <span class="k">end</span>
  
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
